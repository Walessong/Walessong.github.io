(()=>{var a=class{constructor(){this.theme=localStorage.getItem("theme")||"system",this.colorScheme=localStorage.getItem("colorScheme")||document.documentElement.getAttribute("data-theme")||"default",this.init()}init(){this.setupEventListeners(),this.updateUI(),this.loadPromptManagerIfNeeded()}setupDropdown(e){let t=`.dropdown-toggle[data-dropdown-type="${e}"]`,o=`.dropdown-menu[data-dropdown-type="${e}"]`,s=document.querySelectorAll(t),n=document.querySelectorAll(o);s.forEach((d,m)=>{let c=n[m]||n[0];d&&c&&d.addEventListener("click",u=>{u.stopPropagation(),this.closeOtherMenus(e),document.querySelectorAll(o).forEach(l=>{if(l!==c){l.classList.add("hidden");let i=document.querySelector(`${t}[aria-labelledby="${l.getAttribute("aria-labelledby")}"], ${t}[aria-controls="${l.id}"]`);i&&i.setAttribute("aria-expanded","false")}});let h=c.classList.contains("hidden");c.classList.toggle("hidden"),d.setAttribute("aria-expanded",h?"true":"false"),e==="mobile-menu"&&this.handleMobileMenuClick(c,d)})})}loadPromptManagerIfNeeded(){if(!(document.getElementById("category-list")&&document.getElementById("template-list"))||window.__promptManagerLoaded)return;let t=document.createElement("script");t.src="/js/prompt-manager.js",t.defer=!0,t.onload=()=>{window.__promptManagerLoaded=!0},document.head.appendChild(t)}closeOtherMenus(e){["color-scheme","theme","language","mobile-menu"].forEach(o=>{o!==e&&document.querySelectorAll(`.dropdown-menu[data-dropdown-type="${o}"]`).forEach(s=>{s.classList.add("hidden");let n=document.querySelector(`.dropdown-toggle[data-dropdown-type="${o}"]`);n&&n.setAttribute("aria-expanded","false")})})}closeAllDropdowns(){document.querySelectorAll(".dropdown-menu").forEach(e=>{e.classList.add("hidden");let t=e.getAttribute("data-dropdown-type");if(t){let o=document.querySelector(`.dropdown-toggle[data-dropdown-type="${t}"]`);o&&o.setAttribute("aria-expanded","false")}})}closeMobileMenu(){let e=document.getElementById("mobile-menu"),t=document.getElementById("mobile-menu-toggle");e&&e.classList.add("hidden"),t&&t.setAttribute("aria-expanded","false")}closeAllMenus(){this.closeAllDropdowns()}handleMobileMenuClick(e,t){e.addEventListener("click",o=>{o.target.closest("a[href]")&&setTimeout(()=>{e.classList.add("hidden"),t.setAttribute("aria-expanded","false")},100)})}setupMobileMenu(){console.log("\u79FB\u52A8\u7AEF\u83DC\u5355\u4F7F\u7528\u7EDF\u4E00\u7684\u4E0B\u62C9\u83DC\u5355\u5904\u7406\u903B\u8F91")}setupEventListeners(){this.setupDropdown("mobile-menu"),this.setupDropdown("color-scheme"),this.setupDropdown("theme"),this.setupDropdown("language"),document.querySelectorAll('.dropdown-menu[data-dropdown-type="color-scheme"]').forEach(o=>{o&&o.addEventListener("click",s=>{let n=s.target.closest("[data-color-scheme]");if(n){let d=n.getAttribute("data-color-scheme");this.setColorScheme(d),this.closeAllMenus()}})}),document.querySelectorAll('.dropdown-menu[data-dropdown-type="theme"]').forEach(o=>{o&&o.addEventListener("click",s=>{let n=s.target.closest("[data-theme]");if(n){let d=n.getAttribute("data-theme");this.setTheme(d),this.closeAllMenus()}})}),document.addEventListener("click",o=>{o.target.closest(".dropdown-toggle, .dropdown-menu")||this.closeAllMenus()}),document.addEventListener("keydown",o=>{o.key==="Escape"&&this.closeAllMenus()}),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",()=>{this.theme==="system"&&(this.applyTheme(),this.updateUI())})}setColorScheme(e){this.colorScheme=e,localStorage.setItem("colorScheme",e),document.documentElement.setAttribute("data-theme",e),this.updateUI(),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{colorScheme:e,theme:this.theme}}))}setTheme(e){this.theme=e,localStorage.setItem("theme",e),this.applyTheme(),this.updateUI(),window.dispatchEvent(new CustomEvent("themeChanged",{detail:{colorScheme:this.colorScheme,theme:e}}))}applyTheme(){this.theme==="dark"||this.theme==="system"&&window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}updateUI(){let e=document.querySelectorAll(".sun-icon, #sun-icon"),t=document.querySelectorAll(".moon-icon, #moon-icon"),o=document.querySelectorAll(".system-icon, #system-icon");[...e,...t,...o].forEach(s=>{s&&s.classList.add("hidden")}),this.theme==="light"?e.forEach(s=>s.classList.remove("hidden")):this.theme==="dark"?t.forEach(s=>s.classList.remove("hidden")):this.theme==="system"&&o.forEach(s=>s.classList.remove("hidden")),this.updateDropdownSelection()}updateDropdownSelection(){document.querySelectorAll("[data-color-scheme]").forEach(t=>{let o=t.getAttribute("data-color-scheme")===this.colorScheme;t.classList.toggle("bg-accent",o),t.classList.toggle("text-accent-foreground",o)}),document.querySelectorAll("[data-theme]").forEach(t=>{let o=t.getAttribute("data-theme")===this.theme;t.classList.toggle("bg-accent",o),t.classList.toggle("text-accent-foreground",o)});let e=document.documentElement.lang||"en";document.querySelectorAll('.dropdown-menu[data-dropdown-type="language"] a[role="menuitem"]').forEach(t=>{let o=t.getAttribute("href"),s=this.isCurrentLanguageLink(o,e);t.classList.toggle("bg-accent",s),t.classList.toggle("text-accent-foreground",s)})}isCurrentLanguageLink(e,t){return e==="/"&&t==="en"?!0:new RegExp(`^/${t}(/|$)`).test(e)}};document.addEventListener("DOMContentLoaded",()=>{new a;let r=24,e=()=>{window.scrollY>r?document.body.classList.add("is-scrolled"):document.body.classList.remove("is-scrolled")};e(),window.addEventListener("scroll",()=>{window.requestAnimationFrame(e)},{passive:!0})});console.log("Hugo site with advanced UI management loaded.");})();
